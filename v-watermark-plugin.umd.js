!function(t,e){'object'==typeof exports&&'undefined'!=typeof module?e(exports):'function'==typeof define&&define.amd?define(['exports'],e):e((t='undefined'!=typeof globalThis?globalThis:t||self).t={})}(this,(function(t){'use strict';const e=-25,n="14px",o="\u5fae\u8f6f\u96c5\u9ed1",i="normal",l="normal",r="#c9c9c9",s="center",c="middle",u=285,a=400,d=.4,f=9999,h={id:"v-watermark-element",canvas:document.createElement('canvas'),options:{text:[]},o:new MutationObserver((()=>{}))};function v(){return{size:h.options.fontSize||n,family:h.options.fontFamily||o,weight:h.options.fontWeight||i,style:h.options.fontStyle||l}}function m(){var t,o,i;const l=(null!==(t=h.options.rotate)&&void 0!==t?t:e)*Math.PI/180,d=v(),[f,m]=(()=>{const t=h.canvas.getContext("2d");if(!t)return[0,0];t.font=`${d.style} ${d.weight} ${d.size} ${d.family}`;const e=parseInt(d.size);return h.options.text.reduce((([n,o],i)=>{const l=t.measureText(i);return[Math.max(n,l.width),Math.max(o,1.2*e)]}),[0,0])})(),p=Math.cos(l),M=Math.sin(l),b=Math.abs(f*p)+Math.abs(m*M),y=Math.abs(f*M)+Math.abs(m*p),[g,$]=[null!==(o=h.options.i)&&void 0!==o?o:u,null!==(i=h.options.l)&&void 0!==i?i:a];Object.assign(h.canvas,{width:Math.max(2*b,g),height:Math.max(2*y,$)}),[!0,!1].forEach((t=>{!function(t){var o;const i=h.canvas.getContext("2d"),l=null!==(o=h.options.rotate)&&void 0!==o?o:e,u=l*Math.PI/180,{width:a,height:d}=i.canvas,[f,m]=t?[a/4,d/7]:[.75*a,.64*d];i.resetTransform(),i.translate(f,m),i.rotate(u);const p=v();Object.assign(i,{font:`${p.style} ${p.weight} ${p.size} ${p.family}`,fillStyle:h.options.color||r,textAlign:h.options.textAlign||s,textBaseline:h.options.textBaseline||c});const M=1.2*parseInt(h.options.fontSize||n);h.options.text.forEach(((t,e)=>{const n=e*M;i.fillText(t,0,n)}))}(t)}))}function p(){var t,e;if(document.getElementById(h.id))return;const n=document.createElement("div");n.id=h.id,n.style.pointerEvents="none",n.style.position="fixed",n.style.inset="0",n.style.opacity=String(null!==(t=h.options.opacity)&&void 0!==t?t:d),n.style.zIndex=String(null!==(e=h.options.zIndex)&&void 0!==e?e:f),n.style.background=`url(${h.canvas.toDataURL('image/webp',.8)}) left top repeat`,document.body.appendChild(n),M()}const M=()=>{const t=document.getElementById(h.id),e=t.parentNode;h.o=new MutationObserver((n=>{for(const o of n)'childList'!==o.type||e.contains(t)?'attributes'===o.type&&'style'===o.attributeName&&(h.o.disconnect(),t.remove(),p()):(h.o.disconnect(),p())})),h.o.observe(e,{childList:!0}),h.o.observe(t,{attributes:!0,attributeFilter:['style'],subtree:!0})},b=()=>{const t=document.getElementById(h.id);t&&(h.o.disconnect(),document.body.removeChild(t))};t.u=t=>{(t=>{var e;Array.isArray(null==t?void 0:t.text)&&0!==(null===(e=null==t?void 0:t.text)||void 0===e?void 0:e.length)&&!t.text.some((t=>!(null==t?void 0:t.trim())))&&(b(),h.options=t,m(),p())})(t)},t.h=b}));
